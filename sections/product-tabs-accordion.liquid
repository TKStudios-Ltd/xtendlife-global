{% comment %}
  Product Tabs â†’ Mobile Accordion (Dawn)
  Desktop tabs / Mobile accordion
  Bonify Custom Fields namespace: custom_fields
  Metafields pulled:
    - Details col1: product.custom_fields.[product_details/product_description] (fallback to product.description)
    - Ingredients col2: product.custom_fields.product_ingredients
    - Directions & Dosage col1: product.custom_fields.product_directions
  Schema:
    - Details col2 image
    - Ingredients col1 rich text
    - Directions col2 image
    - Shipping col1 rich text
    - Shipping col2 rich text
{% endcomment %}

<section id="product-tabs-accordion" class="product-tabs-accordion product-tabs-accordion--{{ section.id }}" data-section-id="{{ section.id }}" data-section-type="product-tabs-accordion">
  <div class="page-width">
    {%- if product -%}
      {%- comment -%} Gather content (Bonify uses custom_fields namespace) {%- endcomment -%}
      {%- assign details_meta = product.metafields.custom_fields['product_details'] -%}
      {%- if details_meta == blank -%}{% assign details_meta = product.metafields.custom_fields['product_description'] %}{%- endif -%}
      {%- if details_meta == blank -%}{% assign details_meta = product.description %}{%- endif -%}

      {%- assign ingredients_meta = product.metafields.custom_fields['product_ingredients'] -%}
      {%- assign directions_meta  = product.metafields.custom_fields['product_directions'] -%}

      {%- assign details_image = section.settings.details_image -%}
      {%- assign ingredients_text = section.settings.ingredients_text -%}
      {%- assign directions_image = section.settings.directions_image -%}
      {%- assign shipping_col1 = section.settings.shipping_col1 -%}
      {%- assign shipping_col2 = section.settings.shipping_col2 -%}

      {%- comment -%} Ensure headers always show {%- endcomment -%}
      {%- assign tabs_array = 'details,ingredients,directions,shipping' | split: ',' -%}

      <div class="pta__tabs-nav" role="tablist" aria-label="Product information tabs">
        <ul class="pta__tabs-nav-list">
          {%- for key in tabs_array -%}
            {%- assign is_active = forloop.first -%}
            <li>
              <button
                class="pta__tab-btn{% if is_active %} is-active{% endif %}"
                role="tab"
                aria-selected="{% if is_active %}true{% else %}false{% endif %}"
                aria-controls="pta-panel-{{ key }}-{{ section.id }}"
                id="pta-tab-{{ key }}-{{ section.id }}"
                data-tab-target="pta-panel-{{ key }}-{{ section.id }}">
                {%- case key -%}
                  {%- when 'details' -%}{{ section.settings.label_details }}
                  {%- when 'ingredients' -%}{{ section.settings.label_ingredients }}
                  {%- when 'directions' -%}{{ section.settings.label_directions }}
                  {%- when 'shipping' -%}{{ section.settings.label_shipping }}
                {%- endcase -%}
              </button>
            </li>
          {%- endfor -%}
        </ul>
      </div>

      <div class="pta__panels">
        {%- for key in tabs_array -%}
          {%- assign is_active = forloop.first -%}
          <div
            id="pta-panel-{{ key }}-{{ section.id }}"
            class="pta__panel{% if is_active %} is-active{% endif %}"
            role="tabpanel"
            aria-labelledby="pta-tab-{{ key }}-{{ section.id }}">

            <button class="pta__accordion-trigger" aria-expanded="{% if is_active %}true{% else %}false{% endif %}" aria-controls="pta-acc-content-{{ key }}-{{ section.id }}">
                <span class="pta__accordion-title">
                    {%- case key -%}
                    {%- when 'details' -%}{{ section.settings.label_details }}
                    {%- when 'ingredients' -%}{{ section.settings.label_ingredients }}
                    {%- when 'directions' -%}{{ section.settings.label_directions }}
                    {%- when 'shipping' -%}{{ section.settings.label_shipping }}
                    {%- endcase -%}
                </span>
                <span class="pta__accordion-icon" aria-hidden="true">
                    <span class="svg-wrapper">
                        {{- 'icon-plus.svg' | inline_asset_content -}}
                    </span>
                </span>
            </button>

            <div class="pta__accordion-content" id="pta-acc-content-{{ key }}-{{ section.id }}">
              <div class="pta__content pta__content--twocol">
                {%- case key -%}

                  {%- when 'details' -%}
                    <div class="pta__col pta__col-1">
                      {{ details_meta }}
                    </div>
                    <div class="pta__col pta__col-2">

                      {%- if details_image != blank -%}
                        {{ details_image | image_url: width: 1200 | image_tag: loading: 'lazy', alt: product.title }}
                      {%- else -%}
                        <img
                          src="{{ 'https://cdn.shopify.com/s/files/1/2714/9868/files/Placeholder_Image.png' }}"
                          alt="{{ product.title }}"
                          loading="lazy"
                          width="1200"
                          height="auto"
                        >
                      {%- endif -%}

                    </div>

                  {%- when 'ingredients' -%}
                    <div class="pta__col pta__col-1 pta__col-i">
                      {%- if ingredients_text != blank -%}
                        {{ ingredients_text }}
                      {%- endif -%}
                      <a class="button button--thin-arrow" href="/pages/ingredients">Our Ingredients <span class="svg-wrapper">{{- 'icon-arrow.svg' | inline_asset_content -}}</span></a>
                    </div>
                    <div class="pta__col pta__col-2 pta__col-i">
                      {{ ingredients_meta }}
                    </div>

                  {%- when 'directions' -%}
                    <div class="pta__col pta__col-1">
                      {{ directions_meta }}
                    </div>
                    <div class="pta__col pta__col-2">
                      {%- if directions_image != blank -%}
                        {{ directions_image | image_url: width: 1200 | image_tag: loading: 'lazy', alt: product.title }}
                      {%- else -%}
                        <img
                          src="{{ 'https://cdn.shopify.com/s/files/1/2714/9868/files/TBMP_DSC00103_1_1.jpg' }}"
                          alt="{{ product.title }}"
                          loading="lazy"
                          width="1200"
                          height="auto"
                        >
                      {%- endif -%}
                    </div>

                  {%- when 'shipping' -%}
                    <div class="pta__col pta__col-1">
                      {{ shipping_col1 }}
                      {% comment %} <div class="shipping__icons">
                        <div class="shipping__icon">
                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5.45977e-09 8.75C5.45977e-09 7.75544 0.395088 6.80161 1.09835 6.09835C1.80161 5.39509 2.75544 5 3.75 5H26.25C27.2446 5 28.1984 5.39509 28.9017 6.09835C29.6049 6.80161 30 7.75544 30 8.75V12.5H32.55C33.1118 12.5005 33.6664 12.6272 34.1727 12.8709C34.679 13.1145 35.124 13.4688 35.475 13.9075L39.1775 18.5325C39.7102 19.198 40.0003 20.0251 40 20.8775V26.25C40 27.2446 39.6049 28.1984 38.9016 28.9017C38.1984 29.6049 37.2446 30 36.25 30H35C35 31.3261 34.4732 32.5979 33.5355 33.5355C32.5979 34.4732 31.3261 35 30 35C28.6739 35 27.4021 34.4732 26.4645 33.5355C25.5268 32.5979 25 31.3261 25 30H12.5C12.5014 30.6665 12.3696 31.3265 12.1123 31.9413C11.855 32.556 11.4774 33.1132 11.0016 33.5799C10.5259 34.0467 9.96164 34.4136 9.34205 34.6591C8.72246 34.9046 8.06004 35.0238 7.39373 35.0097C6.72742 34.9955 6.07067 34.8483 5.46207 34.5766C4.85348 34.305 4.30534 33.9144 3.84987 33.4279C3.3944 32.9413 3.04079 32.3687 2.80984 31.7435C2.57888 31.1183 2.47524 30.4533 2.505 29.7875C1.77262 29.5297 1.13831 29.051 0.689611 28.4173C0.240914 27.7837 -4.18799e-05 27.0264 5.45977e-09 26.25L5.45977e-09 8.75ZM3.235 27.39C3.68748 26.6506 4.32442 26.0415 5.08332 25.6226C5.84222 25.2036 6.697 24.9892 7.56379 25.0003C8.43058 25.0114 9.27959 25.2476 10.0275 25.6859C10.7754 26.1241 11.3966 26.7493 11.83 27.5H25.67C26.1088 26.74 26.74 26.1088 27.5 25.67V8.75C27.5 8.41848 27.3683 8.10054 27.1339 7.86612C26.8995 7.6317 26.5815 7.5 26.25 7.5H3.75C3.41848 7.5 3.10054 7.6317 2.86612 7.86612C2.6317 8.10054 2.5 8.41848 2.5 8.75V26.25C2.4998 26.4906 2.56905 26.7261 2.69943 26.9284C2.8298 27.1306 3.01577 27.2909 3.235 27.39ZM30 25C30.8777 25 31.7399 25.2311 32.4999 25.6699C33.26 26.1087 33.8912 26.7399 34.33 27.5H36.25C36.5815 27.5 36.8995 27.3683 37.1339 27.1339C37.3683 26.8995 37.5 26.5815 37.5 26.25V20.875C37.4995 20.5913 37.4025 20.3163 37.225 20.095L33.525 15.47C33.4081 15.3236 33.2598 15.2054 33.091 15.124C32.9222 15.0426 32.7374 15.0003 32.55 15H30V25ZM7.5 27.5C6.83696 27.5 6.20107 27.7634 5.73223 28.2322C5.26339 28.7011 5 29.337 5 30C5 30.663 5.26339 31.2989 5.73223 31.7678C6.20107 32.2366 6.83696 32.5 7.5 32.5C8.16304 32.5 8.79893 32.2366 9.26777 31.7678C9.73661 31.2989 10 30.663 10 30C10 29.337 9.73661 28.7011 9.26777 28.2322C8.79893 27.7634 8.16304 27.5 7.5 27.5ZM30 27.5C29.337 27.5 28.7011 27.7634 28.2322 28.2322C27.7634 28.7011 27.5 29.337 27.5 30C27.5 30.663 27.7634 31.2989 28.2322 31.7678C28.7011 32.2366 29.337 32.5 30 32.5C30.663 32.5 31.2989 32.2366 31.7678 31.7678C32.2366 31.2989 32.5 30.663 32.5 30C32.5 29.337 32.2366 28.7011 31.7678 28.2322C31.2989 27.7634 30.663 27.5 30 27.5Z" fill="#1F1946"/>
                            </svg>
                            <p>Free shipping over $100*</p>
                        </div>
                        <div class="shipping__icon">
                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5.45977e-09 8.75C5.45977e-09 7.75544 0.395088 6.80161 1.09835 6.09835C1.80161 5.39509 2.75544 5 3.75 5H26.25C27.2446 5 28.1984 5.39509 28.9017 6.09835C29.6049 6.80161 30 7.75544 30 8.75V12.5H32.55C33.1118 12.5005 33.6664 12.6272 34.1727 12.8709C34.679 13.1145 35.124 13.4688 35.475 13.9075L39.1775 18.5325C39.7102 19.198 40.0003 20.0251 40 20.8775V26.25C40 27.2446 39.6049 28.1984 38.9016 28.9017C38.1984 29.6049 37.2446 30 36.25 30H35C35 31.3261 34.4732 32.5979 33.5355 33.5355C32.5979 34.4732 31.3261 35 30 35C28.6739 35 27.4021 34.4732 26.4645 33.5355C25.5268 32.5979 25 31.3261 25 30H12.5C12.5014 30.6665 12.3696 31.3265 12.1123 31.9413C11.855 32.556 11.4774 33.1132 11.0016 33.5799C10.5259 34.0467 9.96164 34.4136 9.34205 34.6591C8.72246 34.9046 8.06004 35.0238 7.39373 35.0097C6.72742 34.9955 6.07067 34.8483 5.46207 34.5766C4.85348 34.305 4.30534 33.9144 3.84987 33.4279C3.3944 32.9413 3.04079 32.3687 2.80984 31.7435C2.57888 31.1183 2.47524 30.4533 2.505 29.7875C1.77262 29.5297 1.13831 29.051 0.689611 28.4173C0.240914 27.7837 -4.18799e-05 27.0264 5.45977e-09 26.25L5.45977e-09 8.75ZM3.235 27.39C3.68748 26.6506 4.32442 26.0415 5.08332 25.6226C5.84222 25.2036 6.697 24.9892 7.56379 25.0003C8.43058 25.0114 9.27959 25.2476 10.0275 25.6859C10.7754 26.1241 11.3966 26.7493 11.83 27.5H25.67C26.1088 26.74 26.74 26.1088 27.5 25.67V8.75C27.5 8.41848 27.3683 8.10054 27.1339 7.86612C26.8995 7.6317 26.5815 7.5 26.25 7.5H3.75C3.41848 7.5 3.10054 7.6317 2.86612 7.86612C2.6317 8.10054 2.5 8.41848 2.5 8.75V26.25C2.4998 26.4906 2.56905 26.7261 2.69943 26.9284C2.8298 27.1306 3.01577 27.2909 3.235 27.39ZM30 25C30.8777 25 31.7399 25.2311 32.4999 25.6699C33.26 26.1087 33.8912 26.7399 34.33 27.5H36.25C36.5815 27.5 36.8995 27.3683 37.1339 27.1339C37.3683 26.8995 37.5 26.5815 37.5 26.25V20.875C37.4995 20.5913 37.4025 20.3163 37.225 20.095L33.525 15.47C33.4081 15.3236 33.2598 15.2054 33.091 15.124C32.9222 15.0426 32.7374 15.0003 32.55 15H30V25ZM7.5 27.5C6.83696 27.5 6.20107 27.7634 5.73223 28.2322C5.26339 28.7011 5 29.337 5 30C5 30.663 5.26339 31.2989 5.73223 31.7678C6.20107 32.2366 6.83696 32.5 7.5 32.5C8.16304 32.5 8.79893 32.2366 9.26777 31.7678C9.73661 31.2989 10 30.663 10 30C10 29.337 9.73661 28.7011 9.26777 28.2322C8.79893 27.7634 8.16304 27.5 7.5 27.5ZM30 27.5C29.337 27.5 28.7011 27.7634 28.2322 28.2322C27.7634 28.7011 27.5 29.337 27.5 30C27.5 30.663 27.7634 31.2989 28.2322 31.7678C28.7011 32.2366 29.337 32.5 30 32.5C30.663 32.5 31.2989 32.2366 31.7678 31.7678C32.2366 31.2989 32.5 30.663 32.5 30C32.5 29.337 32.2366 28.7011 31.7678 28.2322C31.2989 27.7634 30.663 27.5 30 27.5Z" fill="#1F1946"/>
                            </svg>
                            <p>Lorem ipsum</p>
                        </div>
                        <div class="shipping__icon">
                            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M5.45977e-09 8.75C5.45977e-09 7.75544 0.395088 6.80161 1.09835 6.09835C1.80161 5.39509 2.75544 5 3.75 5H26.25C27.2446 5 28.1984 5.39509 28.9017 6.09835C29.6049 6.80161 30 7.75544 30 8.75V12.5H32.55C33.1118 12.5005 33.6664 12.6272 34.1727 12.8709C34.679 13.1145 35.124 13.4688 35.475 13.9075L39.1775 18.5325C39.7102 19.198 40.0003 20.0251 40 20.8775V26.25C40 27.2446 39.6049 28.1984 38.9016 28.9017C38.1984 29.6049 37.2446 30 36.25 30H35C35 31.3261 34.4732 32.5979 33.5355 33.5355C32.5979 34.4732 31.3261 35 30 35C28.6739 35 27.4021 34.4732 26.4645 33.5355C25.5268 32.5979 25 31.3261 25 30H12.5C12.5014 30.6665 12.3696 31.3265 12.1123 31.9413C11.855 32.556 11.4774 33.1132 11.0016 33.5799C10.5259 34.0467 9.96164 34.4136 9.34205 34.6591C8.72246 34.9046 8.06004 35.0238 7.39373 35.0097C6.72742 34.9955 6.07067 34.8483 5.46207 34.5766C4.85348 34.305 4.30534 33.9144 3.84987 33.4279C3.3944 32.9413 3.04079 32.3687 2.80984 31.7435C2.57888 31.1183 2.47524 30.4533 2.505 29.7875C1.77262 29.5297 1.13831 29.051 0.689611 28.4173C0.240914 27.7837 -4.18799e-05 27.0264 5.45977e-09 26.25L5.45977e-09 8.75ZM3.235 27.39C3.68748 26.6506 4.32442 26.0415 5.08332 25.6226C5.84222 25.2036 6.697 24.9892 7.56379 25.0003C8.43058 25.0114 9.27959 25.2476 10.0275 25.6859C10.7754 26.1241 11.3966 26.7493 11.83 27.5H25.67C26.1088 26.74 26.74 26.1088 27.5 25.67V8.75C27.5 8.41848 27.3683 8.10054 27.1339 7.86612C26.8995 7.6317 26.5815 7.5 26.25 7.5H3.75C3.41848 7.5 3.10054 7.6317 2.86612 7.86612C2.6317 8.10054 2.5 8.41848 2.5 8.75V26.25C2.4998 26.4906 2.56905 26.7261 2.69943 26.9284C2.8298 27.1306 3.01577 27.2909 3.235 27.39ZM30 25C30.8777 25 31.7399 25.2311 32.4999 25.6699C33.26 26.1087 33.8912 26.7399 34.33 27.5H36.25C36.5815 27.5 36.8995 27.3683 37.1339 27.1339C37.3683 26.8995 37.5 26.5815 37.5 26.25V20.875C37.4995 20.5913 37.4025 20.3163 37.225 20.095L33.525 15.47C33.4081 15.3236 33.2598 15.2054 33.091 15.124C32.9222 15.0426 32.7374 15.0003 32.55 15H30V25ZM7.5 27.5C6.83696 27.5 6.20107 27.7634 5.73223 28.2322C5.26339 28.7011 5 29.337 5 30C5 30.663 5.26339 31.2989 5.73223 31.7678C6.20107 32.2366 6.83696 32.5 7.5 32.5C8.16304 32.5 8.79893 32.2366 9.26777 31.7678C9.73661 31.2989 10 30.663 10 30C10 29.337 9.73661 28.7011 9.26777 28.2322C8.79893 27.7634 8.16304 27.5 7.5 27.5ZM30 27.5C29.337 27.5 28.7011 27.7634 28.2322 28.2322C27.7634 28.7011 27.5 29.337 27.5 30C27.5 30.663 27.7634 31.2989 28.2322 31.7678C28.7011 32.2366 29.337 32.5 30 32.5C30.663 32.5 31.2989 32.2366 31.7678 31.7678C32.2366 31.2989 32.5 30.663 32.5 30C32.5 29.337 32.2366 28.7011 31.7678 28.2322C31.2989 27.7634 30.663 27.5 30 27.5Z" fill="#1F1946"/>
                            </svg>
                            <p>Lorem ipsum</p>
                        </div>
                      </div> {% endcomment %}
                      <div class="shipping__features">
                        <div class="shipping__feature">
                            <img src="//www.xtend-life.co.nz/cdn/shop/files/Icon.svg?v=1755353638&amp;width=16" alt="" srcset="//www.xtend-life.co.nz/cdn/shop/files/Icon.svg?v=1755353638&amp;width=16 16w" width="16" height="16" class="multicolumn-card__icon">
                            <p>Trusted Brand for over 25 years</p>
                        </div>
                        <div class="shipping__feature">
                            <img src="//www.xtend-life.co.nz/cdn/shop/files/Icon_1.svg?v=1755353659&amp;width=16" alt="" srcset="//www.xtend-life.co.nz/cdn/shop/files/Icon_1.svg?v=1755353659&amp;width=16 16w" width="16" height="17" class="multicolumn-card__icon">
                            <p>Proudly made in New Zealand</p>
                        </div>
                        <div class="shipping__feature">
                            <img src="//www.xtend-life.co.nz/cdn/shop/files/Icon_2.svg?v=1755353678&amp;width=16" alt="" srcset="//www.xtend-life.co.nz/cdn/shop/files/Icon_2.svg?v=1755353678&amp;width=16 16w" width="16" height="15" class="multicolumn-card__icon">
                            <p>365 Days Guaranteed</p>
                        </div>
                      </div>
                    </div>
                    <div class="pta__col pta__col-2">
                      {{ shipping_col2 }}
                    </div>

                {%- endcase -%}
              </div>
            </div>
          </div>
        {%- endfor -%}
      </div>
    {%- else -%}
      <div class="color-subtext" style="padding:1rem 0"><em>This section must be used on a product template.</em></div>
    {%- endif -%}
  </div>
</section>


{%- style -%}
    .product-tabs-accordion { margin-top: 2rem; }
    .pta__tabs-nav { 
        display: none; 
        border-bottom: 2px solid rgba(31, 25, 70, 0.16); 
        margin-bottom: 3rem; 
    }
    .pta__tabs-nav-list { 
        display: flex; 
        gap: 1rem; 
        list-style: none; 
        padding: 0; 
        margin: 0; 
        flex-wrap: wrap; 
    }
    .pta__tabs-nav-list li {
        flex: 0 0 calc(25% - 1rem);
    }
    .pta__tab-btn {
        position: relative; 
        font-family: var(--font-body-family);
        font-size: 24px;
        font-weight: 400;
        color: rgba(var(--color-foreground), 1);
        padding: 0.5rem 0;
        width: 100%;
        text-align: left;
        margin-bottom: -2px;
        background: none; 
        border: none; 
        cursor: pointer; 
        border-bottom: 2px solid transparent;
    }
    .pta__tab-btn.is-active { border-color: currentColor; font-weight: 500; }
    .pta__panel { border-top: 2px solid rgba(31, 25, 70, 1); }
    .pta__panel.is-active:first-child { border-top: none; }
    .pta__accordion-trigger {
        width: 100%; text-align: left; background: none; border-top: 1px solid rgba(31, 25, 70, 1) !important; border: none; padding: 1rem 0; font: inherit;
        display: flex; align-items: center; justify-content: space-between; cursor: pointer;
    }
    .pta__accordion-icon { transition: transform 200ms ease; }
    .pta__panel.is-active .pta__accordion-trigger[aria-expanded="true"] .pta__accordion-icon { transform: rotate(45deg); }
    .pta__accordion-content { overflow: hidden; max-height: 0; transition: max-height 250ms ease; }
    .pta__content { line-height: 1.6; }
    .pta__content--twocol { display: flex; gap: 2rem; }
    .pta__content--twocol .pta__col { flex: 0 0 100%; }
    .pta__content--twocol .pta__col img { width: 100%; height: auto; }
    .pta__content--twocol .pta__col strong { font-weight: 500; }
    .pta__content--twocol .pta__col a { color: rgba(31, 25, 70, 1); }
    .pta__content--twocol .pta__col .button--thin-arrow { color: white; margin-top: 2rem; }
    .pta__content--twocol .pta__col > *:first-child { margin-top: 0; }
    .pta__content--twocol .pta__col .ingredient-table {
        margin: 0;
        width: 100%;
    }
    .pta__content--twocol .pta__col .ingredient-table .header {
        padding: 0 1.5rem 1.5rem;
        border-radius: 0;
        background: transparent;
        box-shadow: none;
    }
    .pta__content--twocol .pta__col .ingredient-table .header td { padding: 0; }
    .pta__content--twocol .pta__col .ingredient-table .header h2 { margin: 1.5rem 0 0; }
    .pta__content--twocol .pta__col .ingredient-table h2 { margin-left: 1.5rem; }
    .pta__content--twocol .pta__col .ingredient-table .header strong { font-weight: 500; }
    .pta__content--twocol .pta__col .ingredient-table .content td { padding: 0 1.5rem; }
    .pta__content--twocol .pta__col .ingredient-table .content table:not([class]) { box-shadow: none; width: 100%;}
    .pta__content--twocol .pta__col .ingredient-table .content table:not([class]) td, 
    .pta__content--twocol .pta__col .ingredient-table .content table:not([class]) th { padding: 0.5em 1.5rem !important; color: rgba(31, 25, 70, 1); }
    .pta__content--twocol .pta__col .ingredient-table .content table:not([class]) td strong, 
    .pta__content--twocol .pta__col .ingredient-table .content table:not([class]) th strong { font-weight: 500; }
    .pta__content--twocol .pta__col .ingredient-table .content table:not([class]) .column-header { background: #f4f8fb; }
    .pta__content--twocol .pta__col .ingredient-table .content table:not([class]) td a, 
    .pta__content--twocol .pta__col .ingredient-table .content table:not([class]) th a { color: #5fc4ff; }
    .pta__content--twocol .pta__col .ingredient-table .footer { display: block; padding-bottom: 2rem; }
    .pta__content--twocol .pta__col .ingredient-table .footer td { padding: 0 1.5rem; }
    .pta__content--twocol .pta__col-2.pta__col-i p { font-size: 16px; padding: 0 1.5rem; }
    .pta__content--twocol .pta__col-1 ul { padding-left: 2.5rem; }
    .pta__content--twocol .pta__col-2.pta__col-i {
        height: 55rem;
        max-height: 55rem;
        overflow-y: scroll;
        border: 1px solid; 
    }
    .pta__content--twocol .pta__col .shipping__icons { display: flex; gap: 1rem; margin: 5rem 0; }
    .pta__content--twocol .pta__col .shipping__icons .shipping__icon { 
        background: rgba(244, 248, 251, 1);
        border-radius: 6px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.75rem;
        flex: 0 0 160px;
        padding: 1.5rem;
    }
    .pta__content--twocol .pta__col .shipping__icons .shipping__icon svg { width: 40px; height: 40px; }
    .pta__content--twocol .pta__col .shipping__icons .shipping__icon p { margin: 0; font-size: 1.2rem; }
    .pta__content--twocol .pta__col .shipping__features { display: flex; flex-direction: column; gap: 1rem; margin-top: 4rem; }
    .pta__content--twocol .pta__col .shipping__features .shipping__feature { display: flex; gap: 0.75rem; align-items: center; }
    .pta__content--twocol .pta__col .shipping__features .shipping__feature img { width: 1.6rem; height: 1.6rem; }
    .pta__content--twocol .pta__col .shipping__features .shipping__feature p { margin: 0; font-size: 1.4rem; }
    @media (max-width: 989px) {
        .pta__panels { border-bottom: 1px solid rgba(31, 25, 70, 1); margin-bottom: 4rem; }
        .pta__panel { border-top: none; }
        .pta__accordion-title { font-family: var(--font-heading-family); font-size: 20px; font-weight: 500; color: rgb(var(--color-foreground)); }
        .pta__accordion-icon { display: flex; }
        .pta__accordion-icon .svg-wrapper { width: 16px; height: 16px; }
        .pta__accordion-icon .svg-wrapper path { fill: rgba(31, 25, 70, 1); }
        .pta__content--twocol { flex-direction: column; gap: 1rem; padding-top: 1rem; }
        .pta__content--twocol .pta__col > *:first-child { border-radius: 12px; }
        .pta__content--twocol .pta__col p { font-size: 14px; }
        .pta__content--twocol .pta__col h3 { font-size: 18px; }
        .pta__content--twocol .pta__col-2.pta__col-i { margin: 1.5rem 0 2rem; }
        .pta__content--twocol .pta__col .shipping__icons { margin: 3rem 0; }
        .pta__panel.is-active { padding-bottom: 3rem; }
    }
    @media (min-width: 990px) {
        .pta__tabs-nav { display: block; }
        .pta__accordion-trigger { display: none; }
        .pta__accordion-content { max-height: none !important; overflow: visible; }
        .pta__panels > .pta__panel { display: none; padding: 2rem 0 5rem; border-top: none; }
        .pta__panels > .pta__panel.is-active { display: block; }
        .pta__content--twocol { gap: 6rem; }
        .pta__content--twocol > * { break-inside: avoid; }
        .pta__content--twocol .pta__col { flex: 0 0 calc(50% - 3rem); }
        .pta__content--twocol .pta__col > *:first-child { border-radius: 16px; }
        .pta__content--twocol .pta__col p { font-size: 20px; line-height: 1.35; }
        .pta__content--twocol .pta__col h3 { font-size: 24px; }
        .pta__content--twocol .pta__col-1.pta__col-i p { font-size: 24px; line-height: 1.2; }
        .pta__content--twocol .pta__col-1 ul { font-size: 20px; line-height: 1.35; }
    }
    :root { --color-border: rgba(0,0,0,.08); }
{%- endstyle -%}

<script>
  (function() {
    const section = document.querySelector('.product-tabs-accordion--{{ section.id }}');
    if (!section) return;

    const nav = section.querySelector('.pta__tabs-nav');
    const tabButtons = section.querySelectorAll('.pta__tab-btn');
    const panels = section.querySelectorAll('.pta__panel');

    function activateTab(targetId) {
      panels.forEach(p => {
        const isTarget = p.id === targetId;
        p.classList.toggle('is-active', isTarget);
        if (isTarget) { p.removeAttribute('hidden'); }
        else { p.setAttribute('hidden', 'hidden'); }
      });
      tabButtons.forEach(btn => {
        const selected = btn.getAttribute('data-tab-target') === targetId;
        btn.classList.toggle('is-active', selected);
        btn.setAttribute('aria-selected', selected ? 'true' : 'false');
      });
      const activePanel = section.querySelector('#' + targetId);
      if (activePanel) {
        const acc = activePanel.querySelector('.pta__accordion-content');
        if (acc) acc.dataset.open = 'true';
      }
    }

    tabButtons.forEach(btn => {
      btn.addEventListener('click', () => activateTab(btn.getAttribute('data-tab-target')));
    });

    const accordionTriggers = section.querySelectorAll('.pta__accordion-trigger');
    accordionTriggers.forEach(trigger => {
      const panel = trigger.closest('.pta__panel');
      const content = panel.querySelector('.pta__accordion-content');

      function setOpen(el, open) {
        if (open) { el.dataset.open = 'true'; el.style.maxHeight = el.scrollHeight + 'px'; }
        else { el.dataset.open = 'false'; el.style.maxHeight = '0px'; }
      }

      if (panel.classList.contains('is-active')) { setOpen(content, true); trigger.setAttribute('aria-expanded', 'true'); }
      else { setOpen(content, false); trigger.setAttribute('aria-expanded', 'false'); }

      trigger.addEventListener('click', () => {
        const isOpen = trigger.getAttribute('aria-expanded') === 'true';
        section.querySelectorAll('.pta__panel').forEach(p => {
          const t = p.querySelector('.pta__accordion-trigger');
          const c = p.querySelector('.pta__accordion-content');
          if (t && c) { t.setAttribute('aria-expanded', 'false'); setOpen(c, false); p.classList.remove('is-active'); }
        });
        if (!isOpen) {
          trigger.setAttribute('aria-expanded', 'true');
          setOpen(content, true);
          panel.classList.add('is-active');
        }
      });

      const ro = new ResizeObserver(() => {
        if (content.dataset.open === 'true') content.style.maxHeight = content.scrollHeight + 'px';
      });
      ro.observe(content);
    });

    if (!nav) {
      panels.forEach((p, i) => p.classList.toggle('is-active', i === 0));
    }
  })();
</script>

{% schema %}
{
  "name": "Product Tabs",
  "tag": "section",
  "class": "section product-tabs",
  "settings": [
    { "type": "text", "id": "label_details", "label": "Details tab label", "default": "Details" },
    { "type": "image_picker", "id": "details_image", "label": "Details â€“ Column 2 image" },

    { "type": "text", "id": "label_ingredients", "label": "Ingredients tab label", "default": "Ingredients" },
    { "type": "richtext", "id": "ingredients_text", "label": "Ingredients â€“ Column 1 text" },

    { "type": "text", "id": "label_directions", "label": "Directions & Dosage tab label", "default": "Directions & Dosage" },
    { "type": "image_picker", "id": "directions_image", "label": "Directions & Dosage â€“ Column 2 image" },

    { "type": "text", "id": "label_shipping", "label": "Shipping & Returns tab label", "default": "Shipping & Returns" },
    { "type": "richtext", "id": "shipping_col1", "label": "Shipping & Returns â€“ Column 1" },
    { "type": "richtext", "id": "shipping_col2", "label": "Shipping & Returns â€“ Column 2" }
  ],
  "blocks": [],
  "presets": [{ "name": "Product Tabs" }]
}
{% endschema %}
